<!DOCTYPE html>
<html>
<head>
    <title>MouseFollower Animation Example</title>
    <meta charset="utf-8">
    <script src="debug.js"></script>
    <script src="mouseFollower.js"></script>
    <style type="text/css">
        html, body {
            width:  100%;
            height: 100%;
            margin: 0;
            overflow: hidden;
        }
        canvas {
            border: 1px dashed black;
        }
    </style>
</head>

<body onload="init();">
<canvas id="myCanvas" onclick="start()">
    Your browser does not support the canvas tag, bro :(
</canvas>

<script>
    var canvas, ctx, mouseFollowers;

    function init() {
        canvas = document.getElementById('myCanvas');
        ctx = canvas.getContext('2d');

        //Fullscreen canvas
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        mouseFollowers = [];
        //Create more MouseFollower
        for(var i=0; i<10; i++)
        {
            customMouseFollower = new MouseFollower('c.png', canvas);
            customMouseFollower.speed = 1+i*0.5;
            customMouseFollower.rotateSpeed = 1+i*0.2;
            mouseFollowers.push(customMouseFollower);
        }

        //Global events
        canvas.addEventListener('mouseout', mouseOutHandler, false);
        canvas.addEventListener('mouseover', mouseOverHandler, false);
    }

    //Pretty simple animation Loop - clear, draw, move

    function animationLoop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        mouseFollowers.forEach(function (entry) {
            entry.draw()
        });
        mouseFollowers.forEach(function (entry) {
            entry.move()
        });
        //If you need to debug, try this:
        //Draw line from the bind point to the mouse pointer
        //var i = 0;
        //drawLine(mouseFollowers[i].x, mouseFollowers[i].y, mouseFollowers[i].mousePos.x, mouseFollowers[i].mousePos.y);
        //You also can write some information directly in canvas
        //writeMessage(mouseFollowers[i].angle + '|' + mouseFollowers[i].x + '|' + mouseFollowers[i].y);
        requestId = requestAnimationFrame(animationLoop);
    }


    function mouseOutHandler(evt) {
        stop();
    }

    function mouseOverHandler(evt) {
        start();
    }

    function start() {
        requestId = requestAnimationFrame(animationLoop);
    }

    function stop() {
        if (requestId) {
            cancelAnimationFrame(requestId);
        }
    }
</script>
</body>
</html>